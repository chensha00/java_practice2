-- ----------------------------
-- 买家信息表 :主键，姓名，性别，年龄，身份证号，手机，常住地址，职业，工作单位，账户余额
-- ----------------------------
DROP TABLE IF EXISTS buyer;
CREATE TABLE buyer (
  ID BIGINT AUTO_INCREMENT COMMENT '主键',
  `NAME` VARCHAR(20)  COMMENT '姓名',
  SEX CHAR(2)  COMMENT '性别 男或女',
  AGE TINYINT(3)  COMMENT '年龄',
  ID_NUMBER VARCHAR(25)  COMMENT '身份证号',
  TEL VARCHAR(50)  COMMENT '手机',
  PERMANENT_ADDR VARCHAR(150) COMMENT '常住地址',
  PROFESSION VARCHAR(20)  COMMENT '职业',
  WORK_UNIT VARCHAR(150)  COMMENT '工作单位',
  SAVING DECIMAL(15,5) DEFAULT NULL COMMENT '账户余额',
  PRIMARY KEY (ID)
) ENGINE=InnoDB COMMENT='买家信息表';

-- ----------------------------
-- 卖家信息表：主键，姓名，性别，年龄，身份证号，电话，地址，职业，工作单位，账户余额
-- ----------------------------
DROP TABLE IF EXISTS seller;
CREATE TABLE seller (
  ID BIGINT AUTO_INCREMENT COMMENT '主键ID',
  `NAME` VARCHAR(50)  COMMENT '卖家姓名',
  SEX CHAR(2) COMMENT '性别 男或女',
  AGE TINYINT(3) COMMENT '年龄',
  ID_NUMBER VARCHAR(25) COMMENT '身份证号',
  TEL VARCHAR(50) COMMENT '联系电话',
  ADDR VARCHAR(150) COMMENT '地址',
  PROFESSION VARCHAR(50) COMMENT '职业',
  WORK_UNIT VARCHAR(150) COMMENT '工作单位',
  SAVING DECIMAL(15,5) COMMENT '账户余额',
  PRIMARY KEY (`ID`)
) ENGINE=InnoDB COMMENT='卖家信息表';


-- ----------------------------
-- 商品信息表：主键，商品名，商品编号，类型，库存，单价，生产地，生产日期，失效日期，卖家信息，商品计量单位
-- ----------------------------
DROP TABLE IF EXISTS goods;
CREATE TABLE goods (
  ID BIGINT AUTO_INCREMENT COMMENT 'ID主键',
  `NAME` VARCHAR(50) COMMENT '商品名',
  NUMBER VARCHAR(20) COMMENT '商品编号',
  TYPE VARCHAR(32) COMMENT '类型',
  PRICE DECIMAL(15,5) COMMENT '商品进货单价',
  ADDR VARCHAR(150) COMMENT '生产地',
  MAKE_TIME DATETIME  COMMENT '生产日期 yyyy-MM-dd HH:mm:ss',
  EXPIRATION_TIME DATE  COMMENT '失效日期 yyyy-MM-dd',
  UNIT VARCHAR(10) COMMENT '商品计量单位：千克，件，台……',
  PRIMARY KEY (ID)
) ENGINE=InnoDB COMMENT='商品信息';
-- ----------------------------
-- 商品卖家关系：主键，卖家信息，商品信息，单价，库存
-- ----------------------------
DROP TABLE IF EXISTS goods_seller_relation;
CREATE TABLE goods_seller_relation(
  ID BIGINT AUTO_INCREMENT COMMENT 'ID主键',
  NAME VARCHAR(50) COMMENT'商品名称',
  INVENTORY DOUBLE COMMENT '卖家商品库存',
  PRICE DECIMAL(15,5) COMMENT '商品出售单价',
  GOODS_ID BIGINT COMMENT '关联商品表外键'REFERENCES goods(ID),
  SELLER_ID BIGINT  COMMENT '关联卖家表外键' REFERENCES seller(ID),
  PRIMARY KEY (ID),
  CONSTRAINT FK_GOODS_SELLER_RELATION_GOODS_ID FOREIGN KEY (GOODS_ID) REFERENCES goods (ID) ON DELETE NO ACTION ON UPDATE CASCADE,
	CONSTRAINT FK_GOODS_SELLER_RELATION_SELLER_ID FOREIGN KEY (SELLER_ID) REFERENCES seller (ID) ON DELETE NO ACTION ON UPDATE CASCADE
)ENGINE=InnoDB  COMMENT='商品卖家关系';
-- ----------------------------
-- 订单信息：主键，订单编号，买家信息，订单总额，交易状态，订单状态，生成日期，交易完成时间
-- ----------------------------
DROP TABLE IF EXISTS`order`;
CREATE TABLE`order` (
  ID BIGINT AUTO_INCREMENT COMMENT '主键ID',
  NUMBER VARCHAR(30)  COMMENT '订单编号',
  BUYER_ID BIGINT COMMENT '买家信息外键' REFERENCES buyer(ID),
  AMOUNT DECIMAL(20,5) COMMENT '订单总金额',
  IS_SUCCESS TINYINT(1) COMMENT '是否交易成功，1--是，0--否',
  ORDER_STATUS TINYINT(2) COMMENT '订单状态:1--待支付,2--支付成功,3--已完成，4--支付失败，',
  CREATION_TIME DATETIME COMMENT '生成日期 yyyy-MM-dd HH：mm：ss',
  FINISH_TIME DATETIME COMMENT '交易时间 yyyy-MM-dd HH：mm：ss',
  PRIMARY KEY (ID),
  CONSTRAINT FK_ORDER_BUYER_ID FOREIGN KEY (BUYER_ID) REFERENCES buyer (ID) ON DELETE NO ACTION ON UPDATE CASCADE
) ENGINE=InnoDB  COMMENT='订单信息';

-- ----------------------------
-- 账户：主键，账户，密码，冻结状态，注销状态，删除状态，买家信息，卖家信息，添加时间，更新时间
-- ----------------------------
DROP TABLE IF EXISTS account;
CREATE TABLE account (
  ID BIGINT AUTO_INCREMENT COMMENT '主键ID',
  ACCOUNT VARCHAR(30)  COMMENT '账户',
  `PASSWORD` VARCHAR(25) COMMENT '密码',
  IS_FROZEN 	TINYINT(1) DEFAULT '0' COMMENT '是否冻结 0--否，1--是',
  IS_CANCELED TINYINT(1) DEFAULT '0' COMMENT '是否注销 0--否，1--是',
  IS_DELETE TINYINT(1) DEFAULT '0' COMMENT '是否删除 0--否，1--是',
  BUYER_ID BIGINT COMMENT '买家信息外键' REFERENCES buyer(ID),
  SELLER_ID BIGINT COMMENT '卖家信息外键'	REFERENCES seller(ID),
  ADD_TIME DATETIME COMMENT '添加时间 yyyy-MM-dd HH:mm:ss',
  UPDATE_TIME DATETIME COMMENT '更新时间 yyyy-MM-dd HH:mm:ss',
  PRIMARY KEY (Id),
  CONSTRAINT FK_ACCOUNT_SELLER_ID FOREIGN KEY (SELLER_ID) REFERENCES seller (ID) ON DELETE NO ACTION ON UPDATE CASCADE,
  CONSTRAINT FK_ACCOUNT_BUYER_ID FOREIGN KEY (BUYER_ID) REFERENCES buyer (ID) ON DELETE NO ACTION ON UPDATE CASCADE
) ENGINE=InnoDB COMMENT='账户信息表';


-- ----------------------------
-- 订单详情：主键，卖家信息，买家信息，商品信息，订单信息，订单金额，交易状态，订单状态，订单编号，生成日期，完成日期
-- ----------------------------
DROP TABLE IF EXISTS order_detail;
CREATE TABLE order_detail (
  ID 	BIGINT AUTO_INCREMENT COMMENT '主键ID',
  SELLER_ID BIGINT COMMENT '关联卖家表外键' REFERENCES seller(ID),
  BUYER_ID BIGINT COMMENT '关联买家表外键' REFERENCES buyer(ID),
  GOODS_ID BIGINT COMMENT '关联商品表外键' REFERENCES goods(ID),
  ORDER_ID BIGINT COMMENT '关联订单表外键' REFERENCES `order`(ID),
  AMOUNT DECIMAL(20,5) COMMENT '订单总金额',
  IS_SUCCESS TINYINT(1) COMMENT '是否交易成功，1--是，0--否',
  ORDER_STATUS TINYINT(2) COMMENT '订单状态:1--待支付,2--支付成功,3--已完成，4--支付失败，',
  ORDER_NUMBER VARCHAR(30)  COMMENT '订单编号',
  CREATION_TIME DATETIME COMMENT '订单生成日期 yyyy-MM-dd HH：mm：ss',
  FINISH_TIME DATETIME COMMENT '订单完成日期 yyyy-MM-dd HH：mm：ss',
  PRIMARY KEY (ID),
  CONSTRAINT FK_ORDER_DETAIL_SELLER_ID FOREIGN KEY (SELLER_ID) REFERENCES seller (ID) ON UPDATE CASCADE,
  CONSTRAINT FK_ORDER_DETAIL_BUYER_ID FOREIGN KEY (BUYER_ID) REFERENCES buyer (ID) ON UPDATE CASCADE,
  CONSTRAINT FK_ORDER_DETAIL_GOODS_ID FOREIGN KEY (GOODS_ID) REFERENCES goods (ID) ON UPDATE CASCADE,
  CONSTRAINT FK_ORDER_DETAIL_ORDER_ID FOREIGN KEY (ORDER_ID) REFERENCES `order` (ID) ON UPDATE CASCADE
) ENGINE=InnoDB COMMENT='订单信息';

-- ----------------------------
-- 订单流水：主键，订单详情信息，买家信息，卖家信息，流水号，交易金额，交易完成时间
-- ----------------------------
DROP TABLE IF EXISTS order_statement;
CREATE TABLE order_statement (
  ID BIGINT AUTO_INCREMENT COMMENT '主键',
  ORDER_DETAIL_ID BIGINT COMMENT '订单详情外键' REFERENCES order_detail(ID),
  BUYER_ID BIGINT COMMENT '买家信息外键' REFERENCES buyer(ID),
  SELLER_ID BIGINT COMMENT '卖家信息外键' REFERENCES seller(ID),
  NUMBER VARCHAR(20) COMMENT '流水号',
  AMOUNT DECIMAL(20,5) COMMENT '交易金额',
  FINISH_TIME DATETIME COMMENT '交易完成时间，yyyy-MM-dd HH:mm:ss',
  PRIMARY KEY (`ID`),
  CONSTRAINT FK_ORDER_STATEMENT_SELLER_ID FOREIGN KEY (SELLER_ID) REFERENCES seller (ID) ON DELETE NO ACTION ON UPDATE CASCADE,
  CONSTRAINT FK_ORDER_STATEMENT_BUYER_ID FOREIGN KEY (BUYER_ID) REFERENCES buyer (ID) ON DELETE NO ACTION ON UPDATE CASCADE,
  CONSTRAINT FK_ORDER_STATEMENT_ORDER_DETAIL_ID FOREIGN KEY (ORDER_DETAIL_ID) REFERENCES order_detail(ID) ON DELETE NO ACTION ON UPDATE CASCADE
) ENGINE=InnoDB  COMMENT='支付流水表';
